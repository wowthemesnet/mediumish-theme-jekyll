---
layout: post 
title: "Naver Boostcamp-ë™ê¸€ í”„ë¡œì íŠ¸ ìµœì í™” ê³¼ì •(2)"
authors: [hyehyeonmoon]
tags: ["Boostcamp", "6ê¸°", "Donggle"]
image: ../assets/images/post-boostcamp-donggle/donggle_icon.png
featured: true
---


## ì—¬ì •ì˜ ì‹œì‘

![screenshot](../assets/images/post-boostcamp-donggle2/screenshot.png)

- ì§€ë„ë¥¼ ì˜ˆì˜ê²Œ ê¾¸ë©°ë³´ê³  ì‹¶ì—ˆë‹¤. "í´ë¦¬ê³¤"
- ì§€ë„ ìœ„ì— í´ë¦¬ê³¤ì„ ê·¸ë¦¬ëŠ” APIëŠ” [Kakao Map API](https://apis.map.kakao.com/web/sample/drawShape/)ì—ì„œ ì œê³µí•œë‹¤.
- í´ë¦¬ê³¤ì„ ì´ë£¨ëŠ” ì ë“¤ì˜ ì¢Œí‘œë¥¼ í•˜ë‚˜í•˜ë‚˜ ë„£ì–´ì£¼ë©´, ê·¸ê±¸ ì´ì–´ì„œ ê·¸ë ¤ì£¼ëŠ” ë°©ì‹ì´ë‹¤.
- í–‰ì •êµ¬ì—­ ê²½ê³„ ì¢Œí‘œëŠ” [í†µê³„ì§€ë¦¬ì •ë³´ì„œë¹„ìŠ¤ì—ì„œ API](https://sgis.kostat.go.kr/developer/html/openApi/api/data.html#54)ë¥¼ ì œê³µí•œë‹¤. (ì œê³µí•˜ëŠ” ì¢Œí‘œê°€ ìœ„ë„/ê²½ë„ê°€ ì•„ë‹ˆë¼ì„œ ì‚½ì§ˆí•œ ê²ƒì€ ë˜ë‹¤ë¥¸ ì–˜ê¸°...)
- ë°ì´í„°ëŠ” ì–»ì—ˆê³ , ë°©ë²•ë„ ì•Œì•„ì„œ êµ¬í˜„ì„ í–ˆëŠ”ë°.. ëŠë¦¬ë‹¤!

## MySQL vs MongoDB

### MySQLì„ ì„ íƒí•œ ì´ìœ 

- ê°€ì¥ ìµìˆ™í•˜ë‹¤
- ì§€ë„ ì •ë³´ì¸ ìœ„ë„ì™€ ê²½ë„ë¥¼ ì§€ì›í•˜ëŠ” Typeì´ ìˆë‹¤

### MongoDBë¡œ ë³€ê²½í•œ ì´ìœ 

- ì§€ë„ ê²½ê³„ì¢Œí‘œê°€ ë‹¨ì¼í™”ëœ êµ¬ì¡°ë¥¼ ê°€ì§€ê³  ìˆì§€ ì•Šì•„ì„œ ìœ ì—°ì„± ìˆëŠ” ìŠ¤í‚¤ë§ˆê°€ í•„ìš”í•˜ë‹¤
- MongoDBì˜ ìƒ¤ë”©ì„ í†µí•´ì„œ ì¶”í›„ì— ì„œë¹„ìŠ¤ì˜ ê·œëª¨ê°€ ì»¤ì¡Œì„ ë•Œ ìˆ˜í‰ì  í™•ì¥ì„ í•  ìˆ˜ ìˆë‹¤
- MongoDBëŠ” ê°ì²´ ê¸°ë°˜ìœ¼ë¡œ NodeJSì—ì„œ í…Œì´ë¸” ê¸°ë°˜ì˜ MySQLë³´ë‹¤ ë” ì í•©í•˜ë‹¤

## ë°ì´í„° êµ¬ì¡°

### 1. ì„ë² ë”©êµ¬ì¡°

MongoDBë¥¼ ì„ íƒí•˜ê³  **Atlas**ë¡œ í´ëŸ¬ìŠ¤í„°ë¥¼ í•˜ë‚˜ ë§Œë“¤ì–´ì„œ êµ¬í˜„ì„ ì‹œì‘í–ˆë‹¤. (ë³µì„ )

í–‰ì • êµ¬ì—­ì€ ê³„ì¸µì ì¸ êµ¬ì¡°ë¥¼ ê°€ì§€ê³  ìˆë‹¤.

- e.g. ì„œìš¸íŠ¹ë³„ì‹œ â†’ ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ â†’ ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ ì²­ë‹´ë™
- ì´ëŸ¬í•œ êµ¬ì¡°ë¥¼ ë°˜ì˜í•˜ê¸° ìœ„í•´ ì²˜ìŒì—ëŠ” ë‹¤ìŒê³¼ ê°™ì€ êµ¬ì¡°ë¡œ DBì— ì¢Œí‘œ ì •ë³´ë“¤ì„ ì €ì¥í–ˆë‹¤.

```jsx
    [
        {
            address: 'ì„œìš¸íŠ¹ë³„ì‹œ',
            code: 11, // í–‰ì •êµ¬ì—­ì½”ë“œ
            center: [37.56669009036455,126.97834782835902], // ì¤‘ì‹¬ ì¢Œí‘œ
            type: 'Polygon',
            path: [[37.XXX, 126.XXX], ...], // ìˆ˜ì‹­ ê°œì˜ ê²½ê³„ ì¢Œí‘œ
            children: [
                {
                    address: 'ì„œìš¸íŠ¹ë³„ì‹œ ê¸ˆì²œêµ¬',
                    code: 11180,
                    center: [37.46054859031183,126.90085018751672],
                    type: 'Polygon',
                    path: [[37.XXX, 126.XXX], ...],
                    children: [
                        ... // ì„œìš¸íŠ¹ë³„ì‹œ ê¸ˆì²œêµ¬ í•˜ìœ„ ë™ë“¤
                    ]
                },
                ...
            ],
        },
    ...
    ]
```

- ê·¸ ê²°ê³¼ ì»¬ë ‰ì…˜ì—ëŠ” 17ê°œì˜ ë„íë¨¼íŠ¸(íŠ¹ë³„ì‹œ, ê´‘ì—­ì‹œ, ë„)ë§Œ ë‚¨ê²Œ ë˜ì—ˆê³ , ì¿¼ë¦¬ëŠ” ê²°êµ­ ìµœìƒìœ„Documentë¥¼ ì°¾ê¸° ë•Œë¬¸ì— "ì„œìš¸íŠ¹ë³„ì‹œ ê¸ˆì²œêµ¬" í•˜ìœ„ ë™ë“¤ì˜ ê²½ê³„ì¢Œí‘œë§Œ ë¶ˆëŸ¬ì˜¤ë ¤ í•´ë„ "ì„œìš¸íŠ¹ë³„ì‹œ" Document ì „ì²´ë¥¼ ë¶ˆëŸ¬ì™€ì•¼ í–ˆë‹¤. ê°„ë‹¨íˆ ë§í•´ ì €ëŸ° êµ¬ì¡°ë¡œëŠ” ìš°ë¦¬ê°€ ì›í•˜ëŠ” ì¿¼ë¦¬ë¥¼ ì˜ ì§¤ ìˆ˜ê°€ ì—†ë‹¤.
- ì €ë ‡ê²Œ ê°€ì ¸ì˜¨ í›„ì—, {code: 11, children.code: 11010, ...}ì™€ ê°™ì´ ì„ íƒí•  ìˆ˜ëŠ” ìˆìœ¼ë‚˜, ì´ëŠ” ìš°ë¦¬ê°€ ì›í•˜ëŠ” í˜•íƒœê°€ ì•„ë‹ˆì—ˆë‹¤.
        > ê²°êµ­ documentë¥¼ 17ê°œë§Œ ê°€ì§€ê³  ìˆê³ , ì•ˆì— ì •ë³´ê°€ 3ì²œê°œì¯¤ ìˆìœ¼ë‹ˆ ì „í˜€ íš¨ìœ¨ì ì´ì§€ ëª»í•˜ë‹¤...

![Untitled](../assets/images/post-boostcamp-donggle2/Untitled.png)

- documentì˜ ê°¯ìˆ˜ê°€ 17ê°œë§Œ ìˆëŠ”ê±¸ ë³¼ ìˆ˜ ìˆë‹¤.

### 2. 1ì°¨ì› êµ¬ì¡°

ë°ì´í„°ë¥¼ ìì„¸íˆ ì‚´í´ë³´ë‹¤ê°€ ì•„ë˜ì™€ ê°™ì´ **code**ê°€ ê° ì§€ëª…ì— ì£¼ì–´ì¡Œê³  ì§€ì—­ì˜ í¬í•¨ê´€ê³„ë¥¼ ë‚˜íƒ€ë‚´ ì¤€ë‹¤ëŠ” ê²ƒì„ ì•Œê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.

- ì„œìš¸íŠ¹ë³„ì‹œ : **11**
- ì„œìš¸íŠ¹ë³„ì‹œ ì¢…ë¡œêµ¬ : **11**010
- ì„œìš¸íŠ¹ë³„ì‹œ ì¢…ë¡œêµ¬ ì¢…ë¡œ1ë™ : **11010**53

```jsx
    [
        {
            address: 'ì„œìš¸íŠ¹ë³„ì‹œ',
            code: 11, // í–‰ì •êµ¬ì—­ì½”ë“œ
            center: [37.56669009036455,126.97834782835902], // ì¤‘ì‹¬ ì¢Œí‘œ
            type: 'Polygon',
            path: [[37.XXX, 126.XXX], ...], // ìˆ˜ì‹­ ê°œì˜ ê²½ê³„ ì¢Œí‘œ
        },
        {
            address: 'ì„œìš¸íŠ¹ë³„ì‹œ ê¸ˆì²œêµ¬',
                    code: 11180,
                    center: [37.46054859031183,126.90085018751672],
                    type: 'Polygon',
                    path: [[37.XXX, 126.XXX], ...],
        },
        ...
    ]
```

ì´ë¥¼ ì´ìš©í•´ ê³„ì¸µì ìœ¼ë¡œ ë°ì´í„° êµ¬ì¡°ë¥¼ í‘œí˜„í•˜ì§€ ì•Šì•„ë„ ì§€ì—­ë“¤ì˜ í¬í•¨ê´€ê³„ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆê³ , document í•˜ë‚˜ë‹¹ ì§€ì—­ í•˜ë‚˜ë¥¼ ë„£ì–´ ìˆ˜í‰ìœ¼ë¡œ ë§Œë“¤ê¸°ë¡œ í•˜ì˜€ìŠµë‹ˆë‹¤.

![Untitled1](../assets/images/post-boostcamp-donggle2/Untitled1.png)

- documentì˜ ê°¯ìˆ˜ê°€ 3800ê°œë¡œ ëŠ˜ì–´ë‚¬ë‹¤.
- ì´ì œ ì¿¼ë¦¬ë¥¼ ë‚ ë ¤ì„œ ì›í•˜ëŠ” documentë¥¼ ì–»ì„ ìˆ˜ ìˆê²Œ ë˜ì—ˆë‹¤.

## MongoDB Indexing

ê·¸ëŸ°ë°, ë¬¸ì œëŠ” **ì†ë„**ì˜€ë‹¤. APIë¡œ ì›í•˜ëŠ” ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ë•Œ ê±¸ë¦¬ëŠ” ì†ë„ê°€ ì•„ì£¼ ë‹¬íŒ½ì´ğŸŒ

![Untitled2](../assets/images/post-boostcamp-donggle2/Untitled2.gif)

### ì¸ë±ì‹± ê³µë¶€

mongodbëŠ” ì¸ë±ìŠ¤ì˜ ì¢…ë¥˜ë¥¼ í¬ê²Œ 2ê°€ì§€ë¡œ ë³¼ ìˆ˜ ìˆë‹¤.

1. ì¼ë°˜ì ì¸ ì˜¤ë¦„ì°¨ìˆœ / ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
    - ìˆœì„œëŒ€ë¡œ ì •ë ¬í•˜ì—¬ ê°’ì„ ë¹„êµí•˜ëŠ” ë¡œì§
2. text ì¸ë±ìŠ¤
    - ì—­ ì¸ë±ì‹±ê°™ì€ ê³¼ì •ì„ ê±°ì³ì„œ ì „ë¬¸ ê²€ìƒ‰ì„ í• ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ë°©ì‹

### ì¸ë±ìŠ¤ ì ìš©

1. ì¼ë°˜ì ì¸ ì¸ë±ìŠ¤

![Untitled4](../assets/images/post-boostcamp-donggle2/Untitled4.png)

![Untitled5](../assets/images/post-boostcamp-donggle2/Untitled5.png)

ìš°ë¦¬ëŠ” code, nameì— regexì¿¼ë¦¬ë¥¼ ë‚ ë¦¬ë¯€ë¡œ, codeì™€ nameì— ì˜¤ë¦„ì°¨ìˆœ ì¸ë±ìŠ¤ë¥¼ ê±¸ì—ˆë‹¤.

![Untitled6](../assets/images/post-boostcamp-donggle2/Untitled6.png)

ì •ë§ ë†€ëê²Œë„ ë‹¨ 1ë„ë¹¨ë¼ì§€ì§€ ì•Šì•˜ë‹¤. ê·¸ë˜ì„œ, ì¸ë±ìŠ¤ê°€ ì‚¬ìš©ëœê±´ì§€ í™•ì¸ì„ í•´ë³´ì•˜ë‹¤.

ë¶„ëª…íˆ ì‚¬ìš©ë˜ì—ˆëŠ”ë°, ì†ë„ëŠ” ì•ˆë¹¨ë¼ì¡Œë‹¤...?

1. text ì¸ë±ìŠ¤ with ì¼ë°˜ì ì¸ ì¸ë±ìŠ¤

> code: name + name: stringì„ í•¨ê»˜ ì‚¬ìš©

regexì¿¼ë¦¬ëŠ” ì¸ë±ìŠ¤ë¥¼ íƒ€ë„ ì†ë„ê°€ ë³„ë¡œ ì•ˆë¹¨ë¼ì§„ë‹¤ê³  ìƒê°í•˜ê³  textì¸ë±ìŠ¤ë¥¼ ì‚¬ìš©, text queryë¥¼ ë‚ ë ¤ë³´ì•˜ë‹¤.

![Untitled7](../assets/images/post-boostcamp-donggle2/Untitled7.png)

![Untitled8](../assets/images/post-boostcamp-donggle2/Untitled8.png)

ì¸ë±ìŠ¤ëŠ” ì˜ íƒ€ëŠ”ê²ƒ ê°™ë‹¤.

> ë¡œì§ìƒ code ê¸¸ì´ì™€ í•¨ê»˜ ë¹„êµí•´ì•¼í•´ì„œ codeë„ ì¸ë±ìŠ¤ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ì˜€ë‹¤.

![Untitled9](../assets/images/post-boostcamp-donggle2/Untitled9.png)

ê·¸ë˜ë„ ë‹¬íŒ½ì´...ğŸŒ

1. ë³µí•© ì¸ë±ìŠ¤

ë³µí•© ì¸ë±ìŠ¤ë„ ì‚¬ìš©ì„ í•´ë³´ì•˜ë‹¤. ë˜‘ê°™ì´ ëŠë ¸ë‹¤...

> ì‚¬ì§„ì€ ì°ì–´ë†“ì€ê²Œ ì—†ì–´ì„œ... pass

## ìµœì í™” ê³¼ì •

### ìš”ì•½

> ğŸ’¡ ë””ë°”ìš´ì‹±(ì‹œë„) â†’ Drag & Drop
>
> ğŸ’¡ ìƒíƒœ ê´€ë¦¬ / LFU ìºì‹± ê¸°ë°˜ API ìš”ì²­ ì¤„ì´ê¸°
>
> ğŸ’¡ Atlas region ë¬¸ì œ(America -> Japan -> NCloud)
>
> ğŸ’¡ simplify.js

### ë””ë°”ìš´ì‹±(ì‹œë„) â†’ Drag & Drop

ì¤‘ì‹¬ì¢Œí‘œì— ë§ì¶”ì–´ ì§€ë„ë¥¼ ê·¸ë¦¬ë ¤ í•˜ì˜€ê³  ì§€ë„ë§µì„ ë“œë˜ê·¸ í•´ì„œ ì´ë™í•  ë•Œ ì¹´ì¹´ì˜¤ ë§µì—ì„œ ê³„ì†í•´ì„œ ë³€í™”ëœ ì¤‘ì‹¬ì¢Œí‘œì— ëŒ€í•´ ìš”ì²­ì„ ë³´ë‚¸ë‹¤ëŠ” ê²ƒì„ ì•Œì•˜ë‹¤.

ê·¸ë˜ì„œ ì²˜ìŒ ìƒê°í•œ ê²ƒì€ ë””ë°”ìš´ì‹±ìœ¼ë¡œ ì¼ì • ì‹œê°„ì´ ì§€ë‚  ë•Œë§ˆë‹¤ í´ë¦¬ê³¤ì„ ê·¸ë ¤ì£¼ì—ˆë‹¤.

í•˜ì§€ë§Œ ì¹´ì¹´ì˜¤ ë§µì—ì„œ ë“œë˜ê·¸ê°€ ëë‚œ ì‹œì ì— ì´ë²¤íŠ¸ë¥¼ ë‹¬ì•„ì£¼ëŠ” apië¥¼ ì œê³µí•œë‹¤ëŠ” ê²ƒì„ ì•Œê³  ì´ë¥¼ ì ìš©í•´ ë“œë ì‹œì ì—ì„œ í´ë¦¬ê³¤ì„ ì¬ìƒì„±í•˜ëŠ” ë¡œì§ìœ¼ë¡œ ìˆ˜ì •í•˜ì˜€ë‹¤.

- ì¤‘ì‹¬ì¢Œí‘œë¥¼ ê°ì§€

```java
kakao.maps.event.addListener(kakaoMap, 'center_changed', changeCenter);
```

![Nov-19-2021 01-34-18.gif](../assets/images/post-boostcamp-donggle2/Nov-19-2021_01-34-18.gif)

- Drag & Drop

```java
kakao.maps.event.addListener(kakaoMap, 'dragend', changeCenter);
```

![Nov-19-2021 01-34-40.gif](../assets/images/post-boostcamp-donggle2/Nov-19-2021_01-34-40.gif)

### ìƒíƒœ ê´€ë¦¬ / LFU ìºì‹± ê¸°ë°˜ API ìš”ì²­ ì¤„ì´ê¸°

"í´ë¦¬ê³¤ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì†ë„ë¥¼ ì¤„ì´ëŠ” ìµœì í™”"ì™€ëŠ” ì§ì ‘ì ìœ¼ë¡œ ê´€ë ¨ì´ ì—†ëŠ” ì´ì•¼ê¸°.

ìš”ì•½: ìƒíƒœê´€ë¦¬ë¥¼ ì˜í•´ì„œ ì„œë²„ì— `fetch` ìš”ì²­ì„ ì¤„ì—¬ ì„œë²„ì™€ í´ë¼ì´ì–¸íŠ¸ ë¶€í•˜ë¥¼ ì¤„ì˜€ë‹¤. (ëŒì´ì¼œë³´ë‹ˆ ë‹¹ì—°íˆ í•´ì•¼í–ˆë˜ ì‘ì—…..)

1. **í´ë¦¬ê³¤ì´ ì•ˆì •ì ìœ¼ë¡œ ê·¸ë ¤ì§€ê¸°ëŠ” í•˜ê¸° ì‹œì‘í•  ë•Œì— í•œê°€ì§€ ê±°ìŠ¬ë¦¬ëŠ” ë¬¸ì œì ì„ ë°œê²¬í•˜ì˜€ë‹¤.**

- ì˜ˆë¥¼ ë“¤ì–´ ê°™ì€ "ê²½ê¸°ë„" ë‚´ì—ì„œ ì›€ì§ì´ê³  ìˆëŠ”ë°, í´ë¦¬ê³¤ì´ ê¹œë¹¡ê¹œë¹¡ê±°ë¦¬ë©° ë‹¤ì‹œ ê·¸ë ¤ì§€ëŠ” ê²ƒ.

![ê¹œë¹¡ì´ë©° ê·¸ë ¤ì§€ëŠ” í´ë¦¬ê³¤](../assets/images/post-boostcamp-donggle2/statusbefore.gif)

ê¹œë¹¡ì´ë©° ê·¸ë ¤ì§€ëŠ” í´ë¦¬ê³¤

- Drag ê°€ ë°œìƒí•  ë•Œë§ˆë‹¤...  
    > ì§€ë„ì˜ ì¤‘ì‹¬ ì¢Œí‘œê°€ ë³€í•˜ê³ 
    > ì¤‘ì‹¬ ì¢Œí‘œê°€ ë³€í• ë•Œë§ˆë‹¤ ìƒˆë¡œìš´ `fetch`ìš”ì²­ì„ ë³´ë‚´ë„ë¡ í•´ ë†“ì•˜ê¸° ë•Œë¬¸ì— ë°œìƒí•œ ë¬¸ì œì˜€ë‹¤.
- ë‹¤ìŒ `useEffect` í›…ì˜ dependency listë¥¼ ì£¼ëª©!

```tsx
useEffect(() => {
    if (!map) return;

    const managePolygon = async () => {
        // ì¤‘ì‹¬ ì¢Œí‘œì˜ ì£¼ì†Œ ê°€ì ¸ì˜¤ê¸°
        const region = (await coordToRegionCode(latitude, longitude)) as {
            result: Array<string>;
            status: string;
        };

        if (region.status !== 'OK') return;
        // ë°±ì—”ë“œ ìš”ì²­
        const regions = await requestCoord(scale, region.result);
        // í´ë¦¬ê³¤ ê·¸ë¦¬ê¸°
        polygonInstances.current = drawPolygon(
        map,
        regions,
        polygonInstances.current,
        );
    };

    managePolygon();

    return () => {
        if (polygonInstances.current !== null) {
        deletePolygon(polygonInstances.current);
        }
    };
    }, [map, **scale, latitude, longitude**]);
```

- `scale`(ì¶•ì²™)ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë“¯ ì¤Œì¸/ì¤Œì•„ì›ƒ í• ë•Œë„ ê°™ì€ í´ë¦¬ê³¤ì„ ì¬ì°¨ ìš”ì²­í•  ìˆ˜ ìˆëŠ” ì½”ë“œë‹¤.
- **"ê²½ê¸°ë„ ë‚´ì—ì„œ ì›€ì§ì´ê³  ìˆìœ¼ë©´ í´ë¦¬ê³¤ì€ ê·¸ëŒ€ë¡œ ìˆì–´ì•¼ í•˜ëŠ” ê²ƒ ì•„ë‹Œê°€?"**
- ë” ë‚˜ì•„ê°„ ì†”ë£¨ì…˜ ì¤‘ í•œ ê°€ì§€ê°€ **ìºì‹±**ì´ë©°, ë‹¤ìŒì—ì„œ ì‹œë„
- ë˜ë‹¤ë¥¸ ë°©ë²•ìœ¼ë¡œ **"ìƒíƒœê´€ë¦¬"**ë¥¼ í†µí•œ ì†”ë£¨ì…˜ì„ ì‹œë„í•´ë³¼ ìˆ˜ ìˆì—ˆë‹¤.

1. **"ì–´ëŠ ì§€ì—­ì˜ ì–´ëŠ ë‹¨ìœ„ì˜ í´ë¦¬ê³¤ë“¤ì„ ê·¸ë ¤ì•¼ í•˜ëŠ”ê°€"ë¥¼ ê²°ì •í•˜ëŠ” ë°ì—ëŠ” ì§€ë„ì˜ ì¤‘ì‹¬ì˜ ì£¼ì†Œì™€ ì¶•ì²™ `scale` ì´ í•¨ê»˜ ì‚¬ìš©ëœë‹¤.**

- ë°±ì—”ë“œì—ì„œ í´ë¦¬ê³¤ì— ëŒ€í•œ ì¿¼ë¦¬ë¥¼ í•  ë•Œ ì§€ë„ ì¤‘ì‹¬ì˜ (ë™ë‹¨ìœ„ê¹Œì§€ì˜) ì£¼ì†Œë¥¼ ëª¨ë‘ ì‚¬ìš©í•˜ì§€ëŠ” ì•ŠëŠ”ë‹¤.
- ì¶•ì²™ `scale` ì— ë”°ë¼ "ê²½ê¸°ë„"ê¹Œì§€ë§Œ ëŠë“ ê°€ "ê²½ê¸°ë„ ì˜ì •ë¶€ì‹œ"ê¹Œì§€ ëŠì–´ì„œ ì²˜ë¦¬ë¥¼ í•˜ëŠ” ë¶€ë¶„ì´ ìˆë‹¤.

```tsx
const queryPolygon = async (
    scale: number,
    big: string,
    medium: string,
    small: string,
) => {
    let result: Map[] = [];

    switch (true) {
    case scale < 9:
        result = await MapModel.find({
        name: { $regex: new RegExp(**`^${big} ${medium}`**) },
        code: { $regex: /^.......$/ },
        });
        break;
    case 9 <= scale && scale < 12:
        result = await MapModel.find({
        name: { $regex: new RegExp(**`^${big}`**) },
        code: { $regex: /^.....$/ },
        });
        break;
    case 12 <= scale:
        result = await MapModel.find({
        code: { $regex: /^..$/ },
        });
        break;
    }
    return result;
};
```

- ì´ëŸ¬í•œ ë¡œì§ì„ ì°¨ìš©í•œ `range`ë¼ëŠ” ìƒˆë¡œìš´ ìƒíƒœë¥¼ ë„ì…í•˜ì˜€ìœ¼ë©°, ì´ `range`ê°€ ë‹¬ë¼ì§ˆ ë•Œì—ë§Œ `fetch` ìš”ì²­ì„ ë³´ë‚´ë„ë¡ ìˆ˜ì •í•˜ì˜€ë‹¤.

```tsx
useEffect(() => {
    const updateRange = async () => {
        const { latitude, longitude, scale } = position;
            // ì§€ë„ ì¤‘ì‹¬ì ì˜ ì£¼ì†Œë¥¼ ìš”ì²­
        const region = (await coordToRegionCode(latitude, longitude)) as {
        result: Array<string>;
        status: string;
        };
        if (region.status !== kakao.maps.services.Status.OK) return;

            // ì¶•ì²™ê³¼ ì£¼ì†Œë¥¼ ê°€ì§€ê³  ìƒˆë¡œìš´ range ìƒì„±
        **const newRange = {
        region: region.result,
        scale: scale,
        };**

            // ì´ì „ range ìƒíƒœì™€ ë¹„êµ í›„ ë‹¬ë¼ì¡Œì„ ë•Œë§Œ ì—…ë°ì´íŠ¸
            // isRangeEqual()ì€ ìœ„ ë¡œì§ì„ ì°¨ìš©í•œ ë¹„êµ í•¨ìˆ˜
        **setRange((oldRange) => {
        if (isRangeEqual(oldRange, newRange)) return oldRange;
        return newRange;
        });**
    };
    updateRange();
    }, [position]);

useEffect(() => {
    const { scale, region } = range;
    const updatePolygons = async () => {
        const regions = await requestCoord(scale, region);
        const polygons = createPolygons(regions);
        setPolygons(polygons);
    };
    updatePolygons();
    }, [**range**]);
```

![ì–‘ë“¤ì˜ ì¹¨ë¬µ](../assets/images/post-boostcamp-donggle2/statusafter.gif)

1. **ê¹¨ë—í•´ì§„ ë„¤íŠ¸ì›Œí¬ íƒ­ì„ ë³´ë‹ˆ ë§ˆìŒì´ í¸ì•ˆí•´ì¡Œë‹¤.**

- ë¶ˆí•„ìš”í•œ ìš”ì²­ì„ ì¤„ì„ìœ¼ë¡œì¨ ì„œë²„ì™€ í´ë¼ì´ì–¸íŠ¸ì˜ ë¶€í•˜ë¥¼ ê½¤ ì¤„ì¼ ìˆ˜ ìˆì—ˆë‹¤.

### LFU ìºì‹±

ìš°ë¦¬ ì„œë¹„ìŠ¤ëŠ” ì§€ë„ê°€ ì›€ì§ì¼ ë•Œë§ˆë‹¤ ìš”ì²­ì„ ë°›ì•„ì™€ì•¼í•´ì„œ **1.5ì´ˆ(ê°œë³„ ì§€ì—­ ë‹¨ìœ„)ëŠ” ì •ë§ ëŠë¦° ì†ë„**ì—¬ì„œ í° ë¬¸ì œì˜€ë‹¤...

ê·¸ë˜ì„œ, ìºì‹±ì„ í†µí•´ì„œ ì•„ì˜ˆ ìš”ì²­ì„ ë³´ë‚´ì§€ ì•Šë„ë¡ í•´ì•¼ê² ë‹¤ê³  ìƒê°í–ˆë‹¤.

ì±Œë¦°ì§€ë•Œ ê³µë¶€í•˜ì˜€ë˜ LRU, LFUë¥¼ ë– ì˜¬ë ¸ë‹¤.

- LRU: Last Recently Used
- LFU: Last Fequently Used

 ì‚¬ìš© ë¹ˆë„ì— ë”°ë¥¸ LFUìºì‹± ì •ì±…ì„ ì‚¬ìš©í•˜ê¸°ë¡œ í–ˆë‹¤.

![Untitled10](../assets/images/post-boostcamp-donggle2/Untitled10.png)

ì´ëŸ¬í•œ ì½”ë“œë¥¼ ì‚¬ìš©í•´ì„œ ìµœëŒ€ 10ê°œê¹Œì§€ ìµœê·¼ ì‚¬ìš©í•œ ë‚´ìš©ì„ ìºì‹±í•˜ë„ë¡ í•˜ì˜€ë‹¤.

![cache-small.gif](../assets/images/post-boostcamp-donggle2/cache-small.gif)

### Simplify.jsë¡œ ë°ì´í„° ìš©ëŸ‰ ê°ì¶•

í•˜ì§€ë§Œ ì „êµ­ë‹¨ìœ„ ì´ˆê¸° ë Œë”ë§ ì‹œ ì—¬ì „íˆ 10ì´ˆ ë‹¨ìœ„ì˜ ì˜¤ëœ ì‹œê°„ì´ ê±¸ë ¤ì„œ ì „ì²´ í´ë¦¬ê³¤ì´ ê·¸ë ¤ì§ˆ ì •ë„ë¡œ ëŠë ¸ë‹¤. ë”°ë¼ì„œ ì¶”ê°€ì ìœ¼ë¡œ ì„±ëŠ¥ì„ ë†’ì¼ ìˆ˜ ìˆëŠ” ë°©ë²•ì— ëŒ€í•´ Surveyë¥¼ ì§„í–‰í–ˆê³  ê·¸ ê²°ê³¼ simplify ë¼ëŠ” Libraryë¥¼ ì•Œì•„ë³¼ ìˆ˜ ìˆì—ˆë‹¤.

ëŒ€í•œë¯¼êµ­ì˜ GeoJSON ë°ì´í„° íŒŒì¼ì€ ì•½ 50MB ì¸ë°, ì´ë¥¼ simplifyë¥¼ í†µí•´ í›¨ì”¬ ì‘ì€ ì‚¬ì´ì¦ˆë¡œ ë§Œë“¤ ë°©ë²•ì´ ìˆë‹¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤.

ì•„ë˜ì˜ ì›¹ í˜ì´ì§€ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë“¯ì´, simplifyëŠ” ê¸°ì¡´ì˜ ëª¨ì–‘ì„ ìœ ì§€í•˜ë©´ì„œ ì„ ì„ ì´ë£¨ëŠ” ì¢Œí‘œì˜ ìˆ˜ë¥¼ ë§¤ìš° ì¤„ì¼ ìˆ˜ ìˆëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ì´ë¥¼ í†µí•´ ê³ ì„±ëŠ¥ì˜ processingì´ ê°€ëŠ¥í•´ì¡Œë‹¤.

[https://mourner.github.io/simplify-js/](https://mourner.github.io/simplify-js/)

í•´ë‹¹ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì ìš©í•´ ì¢Œí‘œë¥¼ ì¤„ì´ë‹ˆ ì•½ 20MB ìˆ˜ì¤€ì´ ë˜ì—ˆê³ , í•´ë‹¹ ìˆ˜ì¤€ìœ¼ë¡œ ì•½ê°„ì˜ ì„±ëŠ¥ ì°¨ì´ë¥¼ ë” ë³¼ ìˆ˜ ìˆì—ˆìœ¼ë‚˜ í° ì°¨ì´ëŠ” ì—†ì—ˆë‹¤.

ê´€ë ¨ ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

```jsx
const transPolygon = (path: CoordType[]) => {
  const simplifiedPath: Point[] = simplify(
    path.map((coord) => ({ x: coord[0], y: coord[1] } as Point)),
    5,
    true,
  );
  return simplifiedPath.map((coord) =>
    transCoord(Object.values(coord) as CoordType),
  );
};
```

- simplify ì „

![Untitled11](../assets/images/post-boostcamp-donggle2/Untitled11.png)

![Untitled12](../assets/images/post-boostcamp-donggle2/Untitled12.png)

![Untitled13](../assets/images/post-boostcamp-donggle2/Untitled13.png)

- simplify í›„

![Screen Shot 2021-11-19 at 15.09.54.png](../assets/images/post-boostcamp-donggle2/Screen_Shot_2021-11-19_at_15.09.54.png)

![Untitled](../assets/images/post-boostcamp-donggle2/Untitled13.png)

![Untitled](../assets/images/post-boostcamp-donggle2/Untitled14.png)

### MongoDB Regionì— ë”°ë¥¸ ì¿¼ë¦¬ ì†ë„

ìºì‹±ê³¼ Map Shapeë¥¼ ì§„í–‰í–ˆìŒì—ë„ ì´ˆê¸° ë¡œë”© ì†ë„ê°€ ì—¬ì „íˆ ëŠë¦¬ê³  **(ì „ì²´ ë§µ ê¸°ì¤€ ì•½ 3~10ì´ˆ)** ë§µì˜ í¬ê¸°ê°€ ì»¤ì§ˆ ìˆ˜ë¡ ë¡œë”© ì†ë„ê°€ í˜„ì €íˆ ì°¨ì´ë‚˜ëŠ” ê²ƒì„ í™•ì¸í•˜ì˜€ë‹¤.

ì•„ë˜ì™€ ê°™ì´, Map Scale í¬ê¸°ì— ë”°ë¼ ë¡œë”© ì†ë„ê°€ í¬ê²Œ ì°¨ì´ë‚˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆê³  ë§¤ ë Œë”ë§ ì‹œë§ˆë‹¤ í¸ì°¨ê°€ í¬ê²Œ ë‚˜íƒ€ë‚˜ëŠ” ê²ƒì„ í™•ì¸í•˜ê³  í˜¹ì‹œ ë„¤íŠ¸ì›Œí¬ ë¬¸ì œëŠ” ì•„ë‹ê¹Œë¼ëŠ” ì˜ì‹¬ì„ í•˜ê²Œ ë˜ì—ˆë‹¤.

![Untitled2](../assets/images/post-boostcamp-donggle2/Untitled2.png)

![Untitled14](../assets/images/post-boostcamp-donggle2/Untitled14.png)

![Untitled15](../assets/images/post-boostcamp-donggle2/Untitled15.png)

ìš°ë¦¬ íŒ€ì—ì„œ ì‚¬ìš©í•˜ëŠ” Atlas MongoDBê°€ ë¯¸êµ­ Regionì— ìƒì„±ë˜ì–´ ìˆë‹¤ëŠ” ê²ƒì„ ì•Œì•˜ê³  ì´í›„ ì¼ë³¸ Regionì´ ì§€ì›ë˜ëŠ” ê²ƒì„ í™•ì¸í•˜ì—¬ í•˜ë‚˜ì˜ Clusterë¥¼ ì¶”ê°€ ìƒì„±í•˜ì—¬ ì†ë„ ì°¨ì´ë¥¼ ì•Œì•„ë³´ì•˜ë‹¤.

ê·¸ë¦¬ê³ , ì¿¼ë¦¬ì˜ ì†ë„ëŠ” ë¹ ë¥¸ê±´ì§€ í…ŒìŠ¤íŠ¸ë¥¼ í•´ë³´ì•˜ëŠ”ë°...

![Untitled16](../assets/images/post-boostcamp-donggle2/Untitled16.png)

ì¿¼ë¦¬ì˜ ì†ë„ëŠ” **0.003ì´ˆ?** ì˜€ë‹¤...

> ëª½ê³ ë””ë¹„ëŠ” 20 ~ 50ë©”ê°€ë°”ì´íŠ¸ ì •ë„ëŠ” ê±°ì˜ 0ì´ˆë§Œì— ì¿¼ë¦¬ë¥¼ í•  ìˆ˜ ìˆì—ˆë‹¤...

í™•ì¸í•´ë³´ë‹ˆ, ì „ì²´ ë§µ ë¡œë”© ì†ë„ê°€ í˜„ê²©íˆ ë¹¨ë¦¬ì§„ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤. ì•„ë˜ì˜ GIFë¥¼ í†µí•´ ê·¸ ì°¨ì´ë¥¼ í™•ì¸í•˜ì˜€ë‹¤.

ìœ„ì˜ GIFëŠ” ë¯¸êµ­ Regionì—ì„œì˜ ìµœì´ˆ í˜ì´ì§€ ë Œë”ë§ í…ŒìŠ¤íŠ¸ ê²°ê³¼ì´ë©°, ì•„ë˜ëŠ” ì¼ë³¸ Regionì—ì„œì˜ ìµœì´ˆ í˜ì´ì§€ ë Œë”ë§ í…ŒìŠ¤íŠ¸ ê²°ê³¼ì´ë‹¤.

![Untitled2gif](../assets/images/post-boostcamp-donggle2/Untitled2.gif)

![Untitled3gif](../assets/images/post-boostcamp-donggle2/Untitled3.gif)
